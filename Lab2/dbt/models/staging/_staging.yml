version: 2

models:
  - name: stg_stock_price
    description: "Staged stock price data with basic cleansing and derived fields"
    columns:
      - name: symbol
        description: "Stock ticker symbol"
        data_tests:
          - not_null
      - name: date
        description: "Trading date"
        data_tests:
          - not_null
      - name: open
        description: "Opening price"
        data_tests:
          - not_null
      - name: high
        description: "Daily high price"
        data_tests:
          - not_null
      - name: low
        description: "Daily low price"
        data_tests:
          - not_null
      - name: close
        description: "Closing price"
        data_tests:
          - not_null
          - dbt_utils.expression_is_true:
              expression: "> 0"
      - name: volume
        description: "Trading volume"
        data_tests:
          - not_null
      - name: daily_range
        description: "Difference between high and low price"
      - name: daily_change
        description: "Difference between close and open price"
      - name: price_direction
        description: "Price movement direction: UP, DOWN, or FLAT"
        data_tests:
          - accepted_values:
              values: ['UP', 'DOWN', 'FLAT']

